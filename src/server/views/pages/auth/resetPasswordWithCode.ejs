<%- include('../../partials/header'); %>

<div class="govuk-width-container">
    <main class="govuk-main-wrapper " id="main-content" role="main">
        <div class="govuk-grid-row">
            <div class="govuk-grid-column-two-thirds">
                <%- include('../../partials/components/errorSummary', { errors: locals.errors }); %>

                <h1 class="govuk-heading-l">New email sent</h1>
                <p>If a registered email address was found then we have sent an email with a security code. Enter the code below. This code can only be used once.</p>

                <form method="post">
                    <% if (locals.email) { %>
                        <input name="email" value="<%= locals.email %>" type="hidden">
                    <% } %>
                    <div class="govuk-form-group <% if(locals?.errors?.verificationCode) { %>govuk-form-group--error<% } %>">
                        <h2 class="govuk-label-wrapper">
                            <label class="govuk-label govuk-label--s" for="verificationCode">Security code</label>
                        </h2>
                        <% if(locals?.errors?.verificationCode) { %>
                            <p id="verification-code-error" class="govuk-error-message">
                                <%= locals?.errors?.verificationCode %>
                            </p>
                        <% } %>
                        <input class="govuk-input govuk-!-width-two-thirds" id="verificationCode" name="verificationCode" type="text" autocomplete="one-time-code" <% if(locals?.values?.verificationCode) { %>value="<%= locals?.values?.verificationCode %>" <% } %> />
                    </div>
                        <p>If our email doesnâ€™t arrive within 5 minutes, check your spam or trash folder, or contact openregulationplatform@beis.gov.uk.</p>
                    <h2 class="govuk-heading-l">Create new password</h2>
                    <div class="govuk-form-group <% if(locals?.errors?.newPassword) { %>govuk-form-group--error<% } %>">
                        <h2 class="govuk-label-wrapper">
                            <label class="govuk-label govuk-label--s" for="newPassword">Enter your new password</label>
                        </h2>
                        <div id="new-password-hint" class="govuk-hint govuk-!-font-size-16 govuk-!-width-three-quarters">
                            Password must be at least 8 characters long, contain at least 1 number, 1 special character, 1 uppercase and 1 lowercase letter.
                        </div>
                        <% if(locals?.errors?.newPassword) { %>
                            <p id="new-password-error" class="govuk-error-message">
                                <%= locals?.errors?.newPassword %>
                            </p>
                        <% } %>
                        <input class="govuk-input govuk-!-width-one-half" id="newPassword" name="newPassword" type="password" data-module="password-reveal" <% if(locals?.values?.newPassword) { %>value="<%= locals?.values?.newPassword %>" <% } %> />
                    </div>

                    <div class="govuk-form-group <% if(locals?.errors?.confirmPassword) { %>govuk-form-group--error<% } %>">
                        <h2 class="govuk-label-wrapper">
                            <label class="govuk-label govuk-label--s" for="confirmPassword">Confirm password</label>
                        </h2>
                        <% if(locals?.errors?.confirmPassword) { %>
                            <p id="new-password-error" class="govuk-error-message">
                                <%= locals?.errors?.confirmPassword %>
                            </p>
                        <% } %>
                        <input class="govuk-input govuk-!-width-one-half" id="confirmPassword" name="confirmPassword" type="password" data-module="password-reveal" />
                    </div>

                    <button type="submit" class="govuk-button govuk-!-margin-bottom-0" data-module="govuk-button">
                        Continue
                    </button>
                </form>
            </div>
        </div>
    </main>
</div>

<%- include('../../partials/footer'); %>
